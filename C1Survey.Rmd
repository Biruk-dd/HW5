---
title: "C1Survey"
author: "Biruk Demma"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Question 1
#open file

C1Survey <- read.csv('/Users/birukd/Desktop/Class/Fall 2025/ADA/Class activity/class_1_survey_fall_2025.csv')
```


```{r}
#Question 2
# Get number of rows and columns (observations and variables)
dim(C1Survey)  # returns (rows, columns)
```


```{r}
#Question 3
#rename headers

C1Survey <- C1Survey %>%
  rename("ID"= "id", "like_cats"= "Do.you.like.cats.","like_dogs" = "Do.you.like.dogs.", "have_desert" = "If.you.were.stranded.on.a.desert.island..what.is.the.one.item.you.want.to.have.with.you.","slogan"= "If.you.were.to.create.a.slogan.for.your.life..what.would.the.slogan.be...Examples...Eat..drink..and.be.merry..for.tomorrow..we.all.die....Bite.off.more.than.you.can.chew....There.are.far.better.things.ahead.than.any.we.leave.behind...","fav_day"= "What.is.your.favorite.day.of.the.week.","larkORowl"  = "Are.you.a.lark..an.owl..or.a.hummingbird.",  "fav_food"  = "What.is.your.favorite.food.", "fav_drink" = "What.is.your.favorite.drink.", "fav_season" = "What.is.your.favorite.season.","fav_month" = "What.is.your.favorite.Month.","hobby"= "What.is.one.hobby.that.you.enjoy.", "program" = "What.is.your.degree.program.","specialization"= "What.is.your.primary.specialization.", "stat_software" = "What.is.your.primary.statistical.software.","R_exp"  = "What.is.your.level.of.R.experience..1.None..5.Advanced..","coding_comfort" = "How.comfortable.are.you.with.coding.", "coding_length"  = "How.long.have.you.been.coding..in.years.or.months..","top_three"  = "What.are.three.things.you.hope.to.learn.in.this.course.","public_health_interest" ="What.is.your.major.public.health.area.of.interest..e.g..cancer..heart.disease..maternal.child.health..disparities..etc...","fav_num" = "What.is.your.favorite.number.","bday"  = "What.is.your.birth.day..e.g..October.28.report.28..","bmonth"  = "What.is.your.birth.month..e.g..October.28.report.10..","country"   = "What.is.your.home.country.","state"  = "What.is.your.home.state.province.etc.","city"  = "What.is.your.home.city.","highest_educ_level"= "What.is.your.highest.education.level.")
```

```{r}
#Question 4
# Create a named vector with counts of variable types
var_types <- c(
  Character = sum(sapply(C1Survey, is.character)),
  Factor    = sum(sapply(C1Survey, is.factor)),
  Integer   = sum(sapply(C1Survey, is.integer)),
  Numeric   = sum(sapply(C1Survey, is.numeric))
)

# Convert to data frame for table display
var_type_table <- data.frame(
  Type = names(var_types),
  Count = as.vector(var_types)
)

# Print the table
print(var_type_table)
```



```{r}
#Question 5
# Load additional package
library(readr)

# Define month mappings
month_lookup_full <- setNames(1:12, tolower(month.name))
month_lookup_abb  <- setNames(1:12, tolower(month.abb))

# Clean and extract numeric bday and bmonth
C1Survey <- C1Survey %>%
  mutate(
    bday_num   = suppressWarnings(as.numeric(parse_number(as.character(bday)))),
    bmonth_num = suppressWarnings(as.numeric(parse_number(as.character(bmonth)))),
    bmonth_str = tolower(trimws(as.character(bmonth)))
  ) %>%
  mutate(
    bmonth_num = ifelse(is.na(bmonth_num) & bmonth_str %in% names(month_lookup_full),
                        month_lookup_full[bmonth_str], bmonth_num),
    bmonth_num = ifelse(is.na(bmonth_num) & bmonth_str %in% names(month_lookup_abb),
                        month_lookup_abb[bmonth_str], bmonth_num)
  ) %>%
  mutate(
    bday_clean   = ifelse(bday_num >= 1 & bday_num <= 31, bday_num, NA_real_),
    bmonth_clean = ifelse(bmonth_num >= 1 & bmonth_num <= 12, bmonth_num, NA_real_)
  )

# Frequency tables after cleaning
table(C1Survey$bday_clean, useNA = "ifany")
table(C1Survey$bmonth_clean, useNA = "ifany")

# Compute medians
median(C1Survey$bday_clean, na.rm = TRUE)
median(C1Survey$bmonth_clean, na.rm = TRUE)
```


```{r}
#Question 6
# a) Assign seasons using Northern Hemisphere meteorological seasons
C1Survey <- C1Survey %>%
  mutate(
    bseason = case_when(
      bmonth_clean %in% c(12, 1, 2)  ~ "Winter",
      bmonth_clean %in% c(3, 4, 5)   ~ "Spring",
      bmonth_clean %in% c(6, 7, 8)   ~ "Summer",
      bmonth_clean %in% c(9, 10, 11) ~ "Fall",
      TRUE                           ~ NA_character_
    ),
    bseason = factor(bseason, levels = c("Winter", "Spring", "Summer", "Fall"))
  )

# b) Table of bmonths (rows) by bseason (columns)
tab_month_season <- with(C1Survey, table(bmonth_clean, bseason, useNA = "ifany"))
tab_month_season

# c) Add column totals to see how many were born in each season
tab_with_totals <- addmargins(tab_month_season, margin = 2)  # column totals

# Extract and print season totals
season_counts <- colSums(tab_month_season, na.rm = TRUE)
season_counts
```





```{r}
#Question 7
#Among students who like dogs, what is their favorite day of the week?
#Load ggplot2
library(ggplot2)

#Filter dataset for students who like dogs
dog_lovers <- C1Survey %>%
  filter(like_dogs == "Yes" & !is.na(fav_day))

#Reorder the days Monday to Sunday
dog_lovers$fav_day <- factor(
  dog_lovers$fav_day,
  levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday")
)

# Create bar plot of favorite days among dog lovers
ggplot(dog_lovers, aes(x = fav_day)) +
  geom_bar(fill = "darkorange", alpha = 0.8) +
  labs(
    title = "Favorite Day of the Week Among Students Who Like Dogs",
    x = "Favorite Day of the Week",
    y = "Number of Students"
  ) +
  theme_minimal()
```

